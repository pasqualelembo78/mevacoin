Perfetto! Ecco una versione pulita e passo-passo della guida per creare una singola chiave ellittica GPG e configurare wallet-api e api.php con la stessa password, pronta da seguire senza confusione:


---

Guida Pulita – API Key GPG per Mevacoin

1️⃣ Creare da zero una chiave ellittica GPG (modalità expert)

gpg --full-generate-key --expert

Poi scegli:

1. (9) ECC and ECC


2. Curve: (1) Curve 25519


3. Tipo: SC (sign + certify) → conferma


4. Validità: 0 = never expires


5. Nome: mevacoin


6. Email: (lascia vuoto o metti una tua email)


7. Commento: lascia vuoto


8. Conferma Okay


9. Inserisci la passphrase che diventerà la password API (es. Pass0@)



> ⚠️ Nota: breve e semplice, perché wallet-api non accetta password troppo complesse.




---

2️⃣ Estrarre l’ID/Fingerprint della chiave

gpg --list-keys

Otterrai una riga simile:

pub   ed25519 2025-11-23 [SC]
      310CC08B2EB44CCA56D0BB014E6E127308A9E53C
uid                      mevacoin <ls@js.it>

> Copia il fingerprint completo: 310CC08B2EB44CCA56D0BB014E6E127308A9E53C.




---

3️⃣ Salvare la password API in un file protetto

echo "Pass0@" > /etc/mevacoin/api.key
chmod 600 /etc/mevacoin/api.key

> Puoi usare la passphrase scelta prima o generarne una nuova con openssl rand -hex 32.



Cifrare il file con la chiave GPG

gpg --encrypt -r 310CC08B2EB44CCA56D0BB014E6E127308A9E53C /etc/mevacoin/api.key

Questo creerà /etc/mevacoin/api.key.gpg

Elimina il file originale per sicurezza:


shred -u /etc/mevacoin/api.key


---

4️⃣ Configurare wallet-api per usare la stessa password

PASS=$(gpg --decrypt /etc/mevacoin/api.key.gpg 2>/dev/null)

screen -DmS wallet-api ./wallet-api \
  --port 8070 \
  --rpc-bind-ip 0.0.0.0 \
  --enable-cors "*" \
  --rpc-password "$PASS"

> Wallet-api ora accetta solo richieste con questa password.




---

5️⃣ Configurare api.php per usare la stessa password

Nel tuo api.php, sostituisci la parte di definizione API key con:

$api_key = trim(shell_exec("gpg --decrypt /etc/mevacoin/api.key.gpg 2>/dev/null"));

E aggiungi ad ogni chiamata curl:

'X-API-KEY: ' . $api_key,

> In questo modo, wallet-api e api.php usano la stessa password, evitando errori umani.




---

✅ Risultato finale

Una sola chiave GPG ellittica creata correttamente

Una sola password (la passphrase) usata ovunque

Wallet-api avviato con quella password

api.php che usa la stessa password per autenticarsi

Sicurezza semplice e coerente

Nessuna chiave duplicata

Nessuna confusione tra GPG e RPC



---

Se vuoi, posso anche scrivere la versione finale di api.php pronta per leggere direttamente /etc/mevacoin/api.key.gpg e fare tutte le chiamate al wallet senza problemi.

Vuoi che faccia anche quello?
